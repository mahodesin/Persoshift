<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>PersoShift ETF‚ÄëRechner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1 class="main-headline">PersoShift dein Helfer f√ºr Pers√∂nliche Entwicklung</h1>

  <div class="top-info-section">
    <h2>üíº Warum investieren?</h2>
    <div id="whyInvestContent" class="top-info-content">
        <!-- Dynamic content will be injected here by JavaScript -->
    </div>
    <button id="toggleWhyInvestBtn" class="toggle-button">Mehr erfahren</button>
  </div>

  <h1>ETF Sparplan-Rechner</h1>
  <div class="card">
    <label for="start">Startkapital (‚Ç¨)</label>
    <input id="start" type="number" value="0" min="0">
    
    <div class="row">
      <div style="flex: 2;">
        <div class="label-group">
          <label for="rate">Monatsrate (‚Ç¨)</label>
          <button type="button" class="info-btn" data-modal-target="modalMonthlyRate" title="Wieviel soll ich investieren?">?</button>
        </div>
        <input id="rate" type="number" value="100" min="0">
      </div>
      <div style="flex: 1;">
        <label for="currency">W√§hrung</label>
        <select id="currency">
          <option value="EUR" selected>Euro (EUR)</option>
          <option value="USD">US-Dollar (USD)</option>
          <option value="JPY">Japanischer Yen (JPY)</option>
          <option value="GBP">Britisches Pfund (GBP)</option>
          <option value="AUD">Australischer Dollar (AUD)</option>
        </select>
      </div>
    </div>

    <div class="row">
        <div style="flex:2">
            <label for="years">Laufzeit (Jahre)</label>
            <input id="years" type="number" value="40" min="1"> 
        </div>
        <div style="flex:1">
            <label for="startCalendarYear">Start-Kalenderjahr</label>
            <input type="number" id="startCalendarYear" value="" placeholder="z.B. 2025"> 
        </div>
    </div>

    <div>
      <label for="interestRatePreset">Jahresrendite (%)</label>
      <div class="interest-rate-group">
        <select id="interestRatePreset">
          <option value="10">Optimistisch 10%</option>
          <option value="7.6">Realistisch 7,6%</option> 
          <option value="5">Pessimistisch 5%</option>
          <option value="custom">Benutzerdefiniert</option>
        </select>
        <input type="number" id="interestCustom" step="0.1" min="0" style="display:none;" placeholder="z.B. 6.5">
      </div>
      <div class="info-button-group">
          <span class="info-btn-label">S&P500</span>
          <button type="button" class="info-btn" data-modal-target="modalSP500" title="Was ist der S&P 500?">?</button>
          <span class="info-btn-label" style="margin-left:10px;">MSCI World</span>
          <button type="button" class="info-btn" data-modal-target="modalMSCIWorld" title="Was ist der MSCI World?">?</button>
      </div>
    </div>

    <div class="form-group" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
        <div class="row">
            <div>
                <div class="label-group">
                    <label for="etfType">ETF-Typ:</label>
                    <button type="button" class="info-btn" data-modal-target="modalEtfTypeInfo" title="ETF-Typen Erkl√§rung">?</button>
                </div>
                <select id="etfType">
                    <option value="thesaurierend" selected>Thesaurierend</option>
                    <option value="ausschuettend">Aussch√ºttend</option> 
                </select>
            </div>
             <div>
                <div class="label-group">
                    <label for="basiszins">Basiszins p.a. (%):</label>
                     <button type="button" class="info-btn" data-modal-target="modalBasiszinsInfo" title="Was ist der Basiszins?">?</button>
                </div>
                <input type="number" id="basiszins" value="2.29" step="0.01" min="0"> 
            </div>
        </div>
        <div class="row">
            <div>
                 <div class="label-group">
                    <label for="freibetrag">J√§hrlicher Freibetrag (‚Ç¨):</label>
                    <button type="button" class="info-btn" data-modal-target="modalFreibetragInfo" title="Info zum Freibetrag">?</button>
                </div>
                <input type="number" id="freibetrag" value="1000" min="0"> 
            </div>
            <div>
                <div class="label-group">
                    <label for="steuerSatz">Steuersatz (inkl. Soli %):</label>
                    <button type="button" class="info-btn" data-modal-target="modalSteuersatzInfo" title="Info zum Steuersatz">?</button>
                </div>
                <input type="number" id="steuerSatz" value="26.375" step="0.001" min="0">
            </div>
        </div>
    </div>


    <div id="advToggle">Erweiterte Optionen ‚ñº</div>
    <div id="advanced">
      <div class="form-group">
        <h4 style="margin-bottom: 0.5rem; margin-top:0; font-weight:600; color:var(--primary);">Anpassung Monatsrate</h4>
        <div class="row">
            <div>
                <label for="monthlyRateIncrease">Monatsrate um x % p.a. erh√∂hen</label>
                <input id="monthlyRateIncrease" type="number" value="0" step="0.1" min="0">
            </div>
            <div>
                <input type="checkbox" id="stopMonthlyRateEnable">
                <label for="stopMonthlyRateEnable" class="inline-label">Monatsrate beenden?</label>
                <div id="stopMonthlyRateYearContainer" style="display:none; margin-top:0.5rem;">
                    <label for="stopMonthlyRateYear" style="font-size: 0.9rem;">Monatsrate stoppen ab Jahr (Laufjahr):</label>
                    <input type="number" id="stopMonthlyRateYear" min="1" value="10"> 
                </div>
            </div>
        </div>
      </div>
      
      <div class="form-group">
        <h4 style="margin-bottom: 0.5rem; margin-top:0; font-weight:600; color:var(--primary);">Einmalzahlungen</h4>
        <div id="lumpsumEntriesContainer">
          <div class="row main-entry-row">
            <div>
                <label for="lumpsum">Einmalige Einzahlung (‚Ç¨)</label>
                <input id="lumpsum" type="number" value="0" min="0" class="lumpsum-amount">
            </div>
            <div>
                <label for="lumpyear">Einmalige Einzahlung im Jahr (Laufjahr):</label>
                <input id="lumpyear" type="number" value="1" min="1" class="lumpsum-year">
            </div>
          </div>
        </div>
        <button type="button" id="addLumpsumBtn" class="add-btn">+</button> <small>Weitere Einmalzahlung hinzuf√ºgen</small>
      </div>
      
       <div class="form-group">
        <h4 style="margin-bottom: 0.5rem; margin-top:0; font-weight:600; color:var(--primary);">Datums-Eingabeart f√ºr Auszahlungen</h4>
        <div class="row">
            <div>
                 <div class="label-group">
                    <label for="payoutYearType">Jahr-Typ f√ºr Auszahlungen:</label>
                    <button type="button" class="info-btn" data-modal-target="modalDateTypeInfo" title="Laufjahr vs. Kalenderjahr">?</button>
                 </div>
                <select id="payoutYearType">
                    <option value="laufjahr" selected>Laufjahr</option>
                    <option value="kalenderjahr">Kalenderjahr</option>
                </select>
            </div>
        </div>
       </div>

      <div class="form-group">
        <h4 style="margin-bottom: 0.5rem; margin-top:0; font-weight:600; color:var(--primary);">Auszahlungen</h4>
        <div id="oneTimePayoutEntriesContainer">
           <div class="row main-entry-row">
               <div>
                <label>Einmalige Auszahlung (‚Ç¨)</label>
                <input id="payout" type="number" value="0" min="0" class="payout-amount">
               </div>
               <div>
                <label>Auszahlung im Jahr:</label>
                <input id="payoutYear" type="number" value="1" min="1" class="payout-year" placeholder="Jahr">
               </div>
           </div>
        </div>
        <button type="button" id="addOneTimePayoutBtn" class="add-btn">+</button> <small>Weitere einmalige Auszahlung hinzuf√ºgen</small>

        <div class="row" style="margin-top: 1.5rem;"> 
          <div>
              <label for="payoutPlanAmount">Auszahlplan Betrag (‚Ç¨)</label>
              <input id="payoutPlanAmount" type="number" value="0" min="0">
          </div>
        </div>
        <div class="row">
          <div>
            <label for="payoutStartYear">Auszahlplan: Ab Jahr (Laufjahr)</label>
            <input id="payoutStartYear" type="number" value="1" min="1">
          </div>
          <div>
            <label for="payoutInterval">Auszahlplan: Intervall</label>
            <select id="payoutInterval">
              <option value="monthly">Monatlich</option>
              <option value="yearly">J√§hrlich</option>
              <option value="custom">Eigenes Intervall</option>
            </select>
          </div>
          <div>
            <label for="payoutIntervalDays">Auszahlintervall (Tage)</label>
            <input id="payoutIntervalDays" type="number" placeholder="Tage" disabled>
          </div>
        </div>
      </div>
    </div> 
    <button id="resetBtn" class="btn btn-secondary" style="margin-bottom: 0.75rem;">Alle Werte zur√ºcksetzen</button>
    <div class="btn-group">
        <button class="btn active-calc-btn" onclick="calc(false)">Berechnen (Brutto)</button>
        <button class="btn" onclick="calc(true)">Berechnen (Netto)</button>
    </div>
    <div class="tax-note-container">
        <p class="tax-note">Nettoberechnung abzgl. <span id="taxRateDisplay">26.375</span>% Kapitalertragsteuer + Soli (DE).</p>
        <button type="button" class="info-btn" data-modal-target="modalTaxInfo" title="Steuerdetails">?</button>
    </div>
    <div id="warn"></div>
  </div>

  <div id="headline" class="headline-container"></div> 
  <div class="chart-controls">
    <label for="chartAxisToggle">Diagramm-Achse: Kalenderjahre</label>
    <input type="checkbox" id="chartAxisToggle">
  </div>
  <canvas id="chart"></canvas>
  <h3 id="compareChartTitle">Vergleich (Gesamtwertentwicklung)</h3>
  <canvas id="compare"></canvas>
</div>

<div id="infoModal" class="modal">
  <div class="modal-content">
    <span class="modal-close" data-close-modal>&times;</span>
    <h2 id="modalTitle">Info Titel</h2>
    <div id="modalBody"><p>Info Inhalt hier...</p></div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
